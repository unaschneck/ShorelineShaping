clc
clear
close all
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Author: Una Schneck (schneck.una@gmail.com)
% 
% This code 

% u(z) = (u_star/k)*ln(z/z0) <- Law of the Wall
%   z = from z0 to H
%   k = 0.4 (Von Karman Constant, dimensionless)
%       z0 = D/30 <-- assume rough turbulence (constant z0)
%       z0 = kin_visc/(9*u_star) <-- smooth turbulence 
%--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% External function requirements:
%   (1) 
%--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% Code produces:
%   (1)  
%---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% %Aprox time to run: 
%---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% Cite: The Shoreline Shaping Capability of Waves and Tides at Titan's Lakes (Schneck et al.)
% 
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tic
%% --------------------------------------------------- 1 . CHARACTER OF GRAINS AND FLOW --------------------------------------------------------- %% 

% CONSTANTS
k = 0.4; % Von Karman Constant
d50 = [6.35e-5:1e-4:0.01]; % diameters for [finegrain sand gravel] [m]
D_mean = mean(d50); % [m]

%% --------------------------------------------------- 2 . PREVIOUS TIDAL PARAMETERS --------------------------------------------------------- %% 

% PREVIOUS TIDAL MODEL PARAMETERS
u_max_strait = 0.64; % m/s (Vincent 2018) table 3
u_min_strait = 0.12; % m/s (Vincent 2018) table 3
u_max_lake = 0.046; % m/s (Vincent 2016)  
u_min_lake = 0.02; % m/s (Vincent 2016)

% PREVIOUS TIDAL MODEL PARAMETERS AND RESULTS
rho_strait = 550; % kg/m3 (Vincent 2018)
rho_lake = 662; % kg/m3 (Vincent 2016)

dyn_vis_lake = 1736e-6; % Pa.S (Lorenz 2010)
kin_vis_lake = dyn_vis_lake/rho_lake; % m2/s
kin_vis_strait = 3e-7; % m2/s (Vincent 2018)

fluid_strait = [rho_strait kin_vis_strait];
fluid_lake = [rho_lake kin_vis_lake];

max_depth_strait = 15; % m (V-shaped basin) (Vincent 2018)
depth_strait = max_depth_strait/2; % use the average? the reported velocity would be a depth-averaged one
depth_lake = 3; % ~3 m (Vincent 2016, emailed to ask for better precision but not response yet
